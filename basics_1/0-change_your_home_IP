#!/usr/bin/env bash
# Configures localhost and facebook.com resolution in /etc/hosts

# Ensure script is run as root
if [ "$EUID" -ne 0 ]; then
    echo "Please run as root"
    exit 1
fi

HOSTS_FILE="/etc/hosts"
BACKUP_FILE="/etc/hosts.bak"

# Backup /etc/hosts if not already backed up
if [ ! -f "$BACKUP_FILE" ]; then
    cp "$HOSTS_FILE" "$BACKUP_FILE"
fi

# Update localhost to 127.0.0.2
if grep -qE '^127\.0\.0\.1\s+localhost' "$HOSTS_FILE"; then
    sed -i 's/^127\.0\.0\.1\s\+localhost/127.0.0.2 localhost/' "$HOSTS_FILE"
else
    echo "127.0.0.2 localhost" >> "$HOSTS_FILE"
fi

# Update or add facebook.com to 8.8.8.8
if grep -q 'facebook.com' "$HOSTS_FILE"; then
    sed -i 's/.*facebook\.com/8.8.8.8 facebook.com/' "$HOSTS_FILE"
else
    echo "8.8.8.8 facebook.com" >> "$HOSTS_FILE"
fi
